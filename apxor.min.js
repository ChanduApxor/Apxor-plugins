!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e=e||self).Apxor=t()}(this,function(){"use strict";function e(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function t(t){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?e(Object(r),!0).forEach(function(e){s(t,e,r[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):e(Object(r)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))})}return t}function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,d(r.key),r)}}function o(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function s(e,t,n){return(t=d(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,i,o,s,a=[],u=!0,c=!1;try{if(o=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;u=!1}else for(;!(u=(r=o.call(n)).done)&&(a.push(r.value),a.length!==t);u=!0);}catch(e){c=!0,i=e}finally{try{if(!u&&null!=n.return&&(s=n.return(),Object(s)!==s))return}finally{if(c)throw i}}return a}}(e,t)||c(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function u(e){return function(e){if(Array.isArray(e))return l(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||c(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function c(e,t){if(e){if("string"==typeof e)return l(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?l(e,t):void 0}}function l(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function d(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var h=202,g={enable:!0,api_root:"https://server.apxor.com/v2/api",auto_track_events:["click","submit"],cookie_expiration:730,name:"",domain:"",cookie_prefix:"_apx_",idle_time_out:1800,ed_t_time:-1,sct_time:108e5,events:{stop:[],action:[]}},f={debug:!1,honorDNT:!1,idle_time_out:1800,client_id:null,session_id:null,plugins:[],version:"ALL",events_upload_time:-1,retry_time:-1,bulk_upload:!0},v="Opera Mini",p="Opera",m="BlackBerry",S="Internet Explorer Mobile",_="Microsoft Edge",b="Facebook Mobile",w="Chrome",y="Chrome iOS",I="UC Browser",D="Firefox iOS",C="Mobile Safari",E="Safari",A="Android Mobile",k="Konqueror",x="Firefox",O="Internet Explorer",T="Mozilla",F="apx_id",R="_apx_config",N="_apx_ua",P="_apx_sc",V="_apx_ledt",G="_apx_lef",q="_apx_ch",K="_apx_lct",W="_apx_uih",z="apx_in",M="apx_ver",J="apx_lbgt",B="visible",j="APX_PAGE_OPENED",L="apx_app_opened",U="SYSTEM_EVENT",H="NAVIGATION_EVENT",X="APP_EVENT",Y="CLIENT_EVENT",Z="apx_retained_session",Q="qe_state",$="_apx_lEt",ee="_apx_sId",te="_apx_cd",ne="_apx_od",re="_apx_lt_count",ie="_apx_use",oe="_apx_scnm",se="apx_sst",ae="apx_termination_ID",ue=o(function e(){r(this,e)});s(ue,"isCookieAvailable",function(){try{var e=(new Date).getTime()+864e5;document.cookie="cookie_set=cookie_value; expires="+e;for(var t=document.cookie.split(";"),n=0;n<t.length;n++){if(-1!==t[n].indexOf("cookie_set"))return document.cookie="cookie_set=cookie_value; expires=Thu, 01 Jan 1970 00:00:01 GMT;",!0}return!1}catch(e){return!1}}),s(ue,"get",function(e){if(window.document)for(var t=e+"=",n=window.document.cookie.split(";"),r=0;r<n.length;r++){for(var i=n[r];" "===i.charAt(0);)i=i.substring(1,i.length);if(0===i.indexOf(t))return decodeURIComponent(i.substring(t.length,i.length))}return null});var ce,le,de,he,ge=function(e){return void 0===e},fe=function(e){return null===e},ve=function(e){return void 0!==e&&!fe(e)},pe=function(e){return!ve(e)},me=function(e){return"function"==typeof e},Se=function(e){return"string"==typeof e},_e=function(e){return"boolean"==typeof e},be=function(e){return ve(e)&&!fe(e)&&!isNaN(e)},we=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;if(null!=t&&me(t)){var n=e.document;"loading"!==n.readyState?t():me(n.addEventListener)?n.addEventListener("DOMContentLoaded",t):me(e.attachEvent)&&e.attachEvent("onreadystatechange",function(e){"loading"!==n.readyState&&t(e)})}},ye=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){return null};me(t)&&(e.addEventListener("pagehide",function(e){return t(e),""}),e.addEventListener("beforeunload",function(e){return t(e),""}),e.addEventListener("onunload",function(e){return t(e),""}))},Ie=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){return null};me(t)&&(e.removeEventListener("pagehide",t),e.removeEventListener("beforeunload",t),e.removeEventListener("onunload",t))},De=function(e,t,n){me(e.removeEventListener)?e.removeEventListener(t,n):me(e.detachEvent)?e.detachEvent(t,n):e["on"+t]=n},Ce=function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=function(e){return e<10?"0"+e:e},r=e.getFullYear()+"-"+n(e.getMonth()+1)+"-"+n(e.getDate())+"T"+n(e.getHours())+":"+n(e.getMinutes())+":"+n(e.getSeconds());return t?r+e.toTimeString().split(" ")[1].replace(/GMT([+|-])(\d{2})(\d{2})/,"$1$2:$3"):r},Ee=function(){return Date.now()},Ae=function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return t?(t^16*Math.random()>>t/4).toString(16):([1e7]+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g,e)},ke=function(){var e=window.navigator,t=(void 0===e?{}:e).userAgent,n=void 0===t?"":t;switch(!0){case/Windows Phone/i.test(n)||/WPDesktop/.test(n):return"Windows Phone";case/iPad/.test(n):return"iPad";case/iPod/.test(n):return"iPod Touch";case/iPhone/.test(n):return"iPhone";case/(BlackBerry|PlayBook|BB10)/i.test(n):return"BlackBerry";case/Android/.test(n):return"Android";default:return"Desktop"}},xe=function(){var e,n,r,i,o,a,u,c=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},l=c.navigator,d=void 0===l?{}:l,h=d.userAgent,g=void 0===h?"":h,f=d.vendor,F=void 0===f?"":f,R=v,N=p,P=m,V=S,G=_,q=b,K=w,W=y,z=I,M=D,J=C,B=E,j=A,L=k,U=x,H=O,X=T,Y=function(){switch(!0){case g.includes(" OPR/"):return g.includes("Mini")?R:N;case/(BlackBerry|PlayBook|BB10)/i.test(g):return P;case g.includes("IEMobile")||g.includes("WPDesktop"):return V;case g.includes("FBIOS"):return q;case g.includes("Chrome"):return K;case g.includes("CriOS"):return W;case g.includes("Edge"):return G;case g.includes("UCWEB")||g.includes("UCBrowser"):return z;case g.includes("FxiOS"):return M;case F.includes("Apple"):return g.includes("Mobile")?J:B;case g.includes("Android"):return j;case g.includes("Konqueror"):return L;case g.includes("Firefox"):return U;case g.includes("MSIE")||g.includes("Trident/"):return H;case g.includes("Gecko"):return X;default:return""}}(),Z=function(){var e,t=(e={},s(e,V,/rv:(\d+(\.\d+)?)/),s(e,G,/Edge\/(\d+(\.\d+)?)/),s(e,K,/Chrome\/(\d+(\.\d+)?)/),s(e,W,/CriOS\/(\d+(\.\d+)?)/),s(e,z,/(UCBrowser|UCWEB)\/(\d+(\.\d+)?)/),s(e,B,/Version\/(\d+(\.\d+)?)/),s(e,J,/Version\/(\d+(\.\d+)?)/),s(e,N,/(Opera|OPR)\/(\d+(\.\d+)?)/),s(e,U,/Firefox\/(\d+(\.\d+)?)/),s(e,M,/FxiOS\/(\d+(\.\d+)?)/),s(e,L,/Konqueror:(\d+(\.\d+)?)/),s(e,P,/BlackBerry (\d+(\.\d+)?)/),s(e,j,/android\s(\d+(\.\d+)?)/),s(e,H,/(rv:|MSIE )(\d+(\.\d+)?)/),s(e,X,/rv:(\d+(\.\d+)?)/),e)[Y];if(void 0===t)return null;var n=g.match(t);return n?parseFloat(n[n.length-2]):null}(),Q=ke(),$=function(){switch(!0){case/Windows/i.test(g):return/Phone/.test(g)||/WPDesktop/.test(g)?"Windows Phone":"Windows";case/(iPhone|iPad|iPod)/.test(g):return"iOS";case/Android/.test(g):return"Android";case/(BlackBerry|PlayBook|BB10)/i.test(g):return"BlackBerry";case/Mac/i.test(g):return"Mac OS X";case/Linux/.test(g):return"Linux";case/CrOS/.test(g):return"Chrome OS";default:return""}}();return t(t({},(e=c.screen,r=(n=void 0===e?{width:0,height:0}:e).height,i=n.width,o=c.devicePixelRatio,a=void 0===o?1:o,{dimensions:{width:i,height:r},dimensions_in_pixels:{width:(u=function(e){var t=Math.round(e)*a,n=t%10;return t+(n>0?10:0)-n})(i),height:u(r)},dpi:a.toString()})),{},{device:Q,browser_version:Z,browser:Y,os:$})},Oe=function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=t.navigator,i=(void 0===r?{}:r).language,o=n.browser_version,a=n.browser,u=ue.isCookieAvailable();return s(e={},"apx_browser",a),s(e,"apx_browser_version",a+"_"+o),s(e,"apx_language",i),s(e,"apx_cookies_supported",u),e},Te=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.navigator,n=void 0===t?{}:t,r=n.connection,i=void 0===r?{}:r,o=i.effectiveType,s=i.saveData,a=n.platform,u=n.webdriver,c=e.document.referrer,l={};o&&(l.apx_network=o),s&&(l.apx_data_save_mode=s),a&&(l.apx_platform=a),ve(u)&&u&&(l.apx_automation=u),ve(c)&&c.length>0?l.apx_referrer=c:l.apx_referrer="direct";var d=ke();return l.apx_device_type=d,l},Fe=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(e.navigator){var t=e.navigator.doNotTrack;return!("1"===t||"yes"===t)}return!0},Re=function(e){var t=e.document.querySelector("title");return ve(t)&&ve(t.innerText)?t.innerText:"Unknown"},Ne=function(e){return be(e)?Pe(e/1e3):e},Pe=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:3;if(!be(e)||!be(t))return e;if(t%1!=0)return e;var n=Math.pow(10,t);return Math.round(e*n)/n},Ve=function(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).location,t=void 0===e?{}:e,n=t.protocol,r=t.host,i=t.hostName;return"file:"===n||"localhost"===r||"0.0.0.0"===i||"127.0.0.1"===i?"development":"production"},Ge=function(e){return e instanceof Object},qe=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;if(Ge(e)){var r={};return Object.keys(t({},e)).forEach(function(t){var i=e[t],o=t;Se(t)||(o=JSON.stringify(t)),_e(i)||be(i)?ze(r,o,i):Se(i)?r[o]=Me(i):Array.isArray(i)?Ke(r,o,i,n):Ge(i)&&We(r,t,i,n-1)}),r}return{}},Ke=function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;if(r<=0)ze(e,t,JSON.stringify(n));else if(Array.isArray(n)){var i=n;if(i.length>0){var o="";_e(i[0])?o="b":Se(i[0])?o="s":be(i[0])?o="n":Array.isArray(i[0])?o="a":Ge(i[0])&&(o="o");var s=i.length;if(""===o)return void ze(e,t,JSON.stringify(n));for(var a=1;a<s;a++)if("s"===o){if(!Se(i[a]))return void ze(e,t,JSON.stringify(n))}else if("b"===o){if(!_e(i[a]))return void ze(e,t,JSON.stringify(n))}else if("n"===o){if(!be(i[a]))return void ze(e,t,JSON.stringify(n))}else if("a"===o){if(!Array.isArray(i[a]))return void ze(e,t,JSON.stringify(n))}else if("o"===o&&!Ge(i[a]))return void ze(e,t,JSON.stringify(n));if("o"===o)if(r-1<=0){for(var u=[],c=0;c<s;c++)u.push(JSON.stringify(i[c]));ze(e,t,u)}else for(var l=0;l<s;l++)We(e,t,i[l],r-1);else if("a"===o)for(var d=0;d<s;d++)ze(e,t,JSON.stringify(i[d]));else for(var h=0;h<s;h++)ze(e,t,i[h])}else ze(e,t,[])}},We=function e(n,r,i){var o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;o<=0?ze(n,r,JSON.stringify(i)):Object.keys(t({},i)).forEach(function(t){var s=r+"_"+t,a=i[t];ve(a)&&(Array.isArray(a)?Ke(n,s,a,o-1):Ge(a)?e(n,s,a,o-1):ze(n,s,a))})},ze=function(e,t,n){if(ve(t)&&ve(n))if(e[t]){var r=e[t],i=r;Array.isArray(r)||((be(r)&&!be(n)||_e(r)&&!_e(n)||Se(r)&&!Se(n)||Ge(r)&&!Ge(n))&&(Se(r)||(r=JSON.stringify(r)),Se(n)||(n=JSON.stringify(n))),(i=[]).push(r)),i.push(n),e[t]=i}else e[t]=n},Me=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:120;return Se(e)?e.length>t?e.slice(0,t)+"...":e:void 0},Je=function(e){if(!ve(e)&&!Se(e))return null;if("object"===n(e)||Ge(e))return e;var t=e.replace(/(?:\r\n|\r|\n)/g,"").trim();try{return JSON.parse(t)}catch(e){}return null},Be=function(e,t){return ve(t)?function(e){var t,n,r,i,o,s,a,u,c,l=0,d="";if(!e)return e;do{t=e[l++],n=e[l++],r=e[l++],i=(u=t<<16|n<<8|r)>>18&63,o=u>>12&63,s=u>>6&63,a=63&u,d+=Le.charAt(i)+Le.charAt(o)+Le.charAt(s)+Le.charAt(a)}while(l<e.length);return((c=e.length%3)?d.slice(0,c-3):d)+"===".slice(c||3)}(t=function(e,t){return Array.from(t).map(function(t,n){return t.charCodeAt(0)^Ue(e,n)})}(e,t)):null},je=function(e,t){return function(e,t){return Array.from(t).map(function(t,n){return String.fromCharCode(t^Ue(e,n))}).join("")}(e,t=function(e){var t,n,r,i,o,s,a,u,c=0,l=[];if(!e)return e;e+="";do{i=Le.indexOf(e.charAt(c++)),o=Le.indexOf(e.charAt(c++)),s=Le.indexOf(e.charAt(c++)),a=Le.indexOf(e.charAt(c++)),t=(u=i<<18|o<<12|s<<6|a)>>16&255,n=u>>8&255,r=255&u,l.push(t),64!==s&&(l.push(n),64!==a&&l.push(r))}while(c<e.length);return l}(t))},Le="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function Ue(e,t){return e.charCodeAt(Math.floor(t%e.length))}String.prototype.includes||(String.prototype.includes=function(){return-1!==String.prototype.indexOf.apply(this,arguments)}),Array.from||(Array.from=(ce=Object.prototype.toString,le=function(e){return"function"==typeof e||"[object Function]"===ce.call(e)},de=Math.pow(2,53)-1,he=function(e){var t=function(e){var t=Number(e);return isNaN(t)?0:0!==t&&isFinite(t)?(t>0?1:-1)*Math.floor(Math.abs(t)):t}(e);return Math.min(Math.max(t,0),de)},function(e){var t=Object(e);if(null==e)throw new TypeError("Array.from requires an array-like object - not null or undefined");var n,r=arguments.length>1?arguments[1]:void 0;if(void 0!==r){if(!le(r))throw new TypeError("Array.from: when provided, the second argument must be a function");arguments.length>2&&(n=arguments[2])}for(var i,o=he(t.length),s=le(this)?Object(new this(o)):new Array(o),a=0;a<o;)i=t[a],s[a]=r?void 0===n?r(i,a):r.call(n,i,a):i,a+=1;return s.length=o,s})),Array.prototype.includes||Object.defineProperty(Array.prototype,"includes",{value:function(e,t){if(null==this)throw new TypeError('"this" is null or not defined');var n=Object(this),r=n.length>>>0;if(0===r)return!1;var i,o,s=0|t,a=Math.max(s>=0?s:r-Math.abs(s),0);for(;a<r;){if((i=n[a])===(o=e)||"number"==typeof i&&"number"==typeof o&&isNaN(i)&&isNaN(o))return!0;a++}return!1}});var He=["log","debug","info","warn","error"],Xe=He.reduce(function(e,t){return e[t]=t,e},{}),Ye=function(e){if(ge(e)){var t=function(){return null};e=He.reduce(function(e,n){return e[n]=t,e},{})}return e},Ze=function(){function e(){r(this,e)}return o(e,null,[{key:"enabled",set:function(t){e._enabled=t}},{key:"level",set:function(t){e._level=t}},{key:"console",set:function(t){e._console=Ye(t)}}]),e}();function Qe(e,t){var n=(65535&e)+(65535&t);return(e>>16)+(t>>16)+(n>>16)<<16|65535&n}function $e(e,t,n,r,i,o){return Qe((s=Qe(Qe(t,e),Qe(r,o)))<<(a=i)|s>>>32-a,n);var s,a}function et(e,t,n,r,i,o,s){return $e(t&n|~t&r,e,t,i,o,s)}function tt(e,t,n,r,i,o,s){return $e(t&r|n&~r,e,t,i,o,s)}function nt(e,t,n,r,i,o,s){return $e(t^n^r,e,t,i,o,s)}function rt(e,t,n,r,i,o,s){return $e(n^(t|~r),e,t,i,o,s)}function it(e,t){var n,r,i,o,s;e[t>>5]|=128<<t%32,e[14+(t+64>>>9<<4)]=t;var a=1732584193,u=-271733879,c=-1732584194,l=271733878;for(n=0;n<e.length;n+=16)r=a,i=u,o=c,s=l,a=et(a,u,c,l,e[n],7,-680876936),l=et(l,a,u,c,e[n+1],12,-389564586),c=et(c,l,a,u,e[n+2],17,606105819),u=et(u,c,l,a,e[n+3],22,-1044525330),a=et(a,u,c,l,e[n+4],7,-176418897),l=et(l,a,u,c,e[n+5],12,1200080426),c=et(c,l,a,u,e[n+6],17,-1473231341),u=et(u,c,l,a,e[n+7],22,-45705983),a=et(a,u,c,l,e[n+8],7,1770035416),l=et(l,a,u,c,e[n+9],12,-1958414417),c=et(c,l,a,u,e[n+10],17,-42063),u=et(u,c,l,a,e[n+11],22,-1990404162),a=et(a,u,c,l,e[n+12],7,1804603682),l=et(l,a,u,c,e[n+13],12,-40341101),c=et(c,l,a,u,e[n+14],17,-1502002290),a=tt(a,u=et(u,c,l,a,e[n+15],22,1236535329),c,l,e[n+1],5,-165796510),l=tt(l,a,u,c,e[n+6],9,-1069501632),c=tt(c,l,a,u,e[n+11],14,643717713),u=tt(u,c,l,a,e[n],20,-373897302),a=tt(a,u,c,l,e[n+5],5,-701558691),l=tt(l,a,u,c,e[n+10],9,38016083),c=tt(c,l,a,u,e[n+15],14,-660478335),u=tt(u,c,l,a,e[n+4],20,-405537848),a=tt(a,u,c,l,e[n+9],5,568446438),l=tt(l,a,u,c,e[n+14],9,-1019803690),c=tt(c,l,a,u,e[n+3],14,-187363961),u=tt(u,c,l,a,e[n+8],20,1163531501),a=tt(a,u,c,l,e[n+13],5,-1444681467),l=tt(l,a,u,c,e[n+2],9,-51403784),c=tt(c,l,a,u,e[n+7],14,1735328473),a=nt(a,u=tt(u,c,l,a,e[n+12],20,-1926607734),c,l,e[n+5],4,-378558),l=nt(l,a,u,c,e[n+8],11,-2022574463),c=nt(c,l,a,u,e[n+11],16,1839030562),u=nt(u,c,l,a,e[n+14],23,-35309556),a=nt(a,u,c,l,e[n+1],4,-1530992060),l=nt(l,a,u,c,e[n+4],11,1272893353),c=nt(c,l,a,u,e[n+7],16,-155497632),u=nt(u,c,l,a,e[n+10],23,-1094730640),a=nt(a,u,c,l,e[n+13],4,681279174),l=nt(l,a,u,c,e[n],11,-358537222),c=nt(c,l,a,u,e[n+3],16,-722521979),u=nt(u,c,l,a,e[n+6],23,76029189),a=nt(a,u,c,l,e[n+9],4,-640364487),l=nt(l,a,u,c,e[n+12],11,-421815835),c=nt(c,l,a,u,e[n+15],16,530742520),a=rt(a,u=nt(u,c,l,a,e[n+2],23,-995338651),c,l,e[n],6,-198630844),l=rt(l,a,u,c,e[n+7],10,1126891415),c=rt(c,l,a,u,e[n+14],15,-1416354905),u=rt(u,c,l,a,e[n+5],21,-57434055),a=rt(a,u,c,l,e[n+12],6,1700485571),l=rt(l,a,u,c,e[n+3],10,-1894986606),c=rt(c,l,a,u,e[n+10],15,-1051523),u=rt(u,c,l,a,e[n+1],21,-2054922799),a=rt(a,u,c,l,e[n+8],6,1873313359),l=rt(l,a,u,c,e[n+15],10,-30611744),c=rt(c,l,a,u,e[n+6],15,-1560198380),u=rt(u,c,l,a,e[n+13],21,1309151649),a=rt(a,u,c,l,e[n+4],6,-145523070),l=rt(l,a,u,c,e[n+11],10,-1120210379),c=rt(c,l,a,u,e[n+2],15,718787259),u=rt(u,c,l,a,e[n+9],21,-343485551),a=Qe(a,r),u=Qe(u,i),c=Qe(c,o),l=Qe(l,s);return[a,u,c,l]}function ot(e){var t,n="",r=32*e.length;for(t=0;t<r;t+=8)n+=String.fromCharCode(e[t>>5]>>>t%32&255);return n}function st(e){var t,n=[];for(n[(e.length>>2)-1]=void 0,t=0;t<n.length;t+=1)n[t]=0;var r=8*e.length;for(t=0;t<r;t+=8)n[t>>5]|=(255&e.charCodeAt(t/8))<<t%32;return n}function at(e){var t,n,r="";for(n=0;n<e.length;n+=1)t=e.charCodeAt(n),r+="0123456789abcdef".charAt(t>>>4&15)+"0123456789abcdef".charAt(15&t);return r}function ut(e){return unescape(encodeURIComponent(e))}function ct(e){return function(e){return ot(it(st(e),8*e.length))}(ut(e))}function lt(e,t){return function(e,t){var n,r,i=st(e),o=[],s=[];for(o[15]=s[15]=void 0,i.length>16&&(i=it(i,8*e.length)),n=0;n<16;n+=1)o[n]=909522486^i[n],s[n]=1549556828^i[n];return r=it(o.concat(st(t)),512+8*t.length),ot(it(s.concat(r),640))}(ut(e),ut(t))}s(Ze,"_console",Ye()),s(Ze,"_enabled",!1),s(Ze,"_level","error"),s(Ze,"_render",function(e){return function(){var t=He.indexOf(e)>=He.indexOf(Ze._level);if(Ze._enabled&&t){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];Ze._console[e].apply(Ze._console,r)}}}),s(Ze,"log",Ze._render(Xe.log)),s(Ze,"info",Ze._render(Xe.info)),s(Ze,"debug",Ze._render(Xe.debug)),s(Ze,"warn",Ze._render(Xe.warn)),s(Ze,"error",Ze._render(Xe.error));var dt=function(e,t,n){return t?n?lt(t,e):at(lt(t,e)):n?ct(e):at(ct(e))},ht=o(function e(){var t=this;r(this,e),s(this,"uNpK",function(e,n){if(t._listeners[e])for(var r=t._listeners[e],i=0;i<r.length;i++){(0,r[i])(n)}}),s(this,"registerForEvent",function(e,n){var r;me(n)&&((r=t._listeners[e]?t._listeners[e]:[]).push(n),t._listeners[e]=r)}),s(this,"unregisterFromEvent",function(e,n){if(t._listeners[e]){for(var r=t._listeners[e],i=[],o=0;o<r.length;o++){var s=r[o];s!==n&&i.push(s)}t._listeners[e]=i}}),s(this,"RmyJ",function(){t._listeners={}}),this._listeners={}}),gt=function(e,t){return{name:e===B?"FOREGROUND":"BACKGROUND",time:be(t)?Pe(t):0}},ft=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0;if(Se(e)&&Ge(t))return{name:e,additional_info:t,category:ve(n)&&Se(n)?n:void 0,time:be(r)?Pe(r):0}},vt=function(e,t,n,r,i){return{app_name:e,app_version:i=ve(i)?i:"ALL",bundle_id:t,installation_time:n,app_mode:r}},pt=function(e,t,n,r,i,o,s,a){return{id:e,hardware_model:t,dimensions:n,os_version:r,platform:"web",dpi:i,dimensions_in_pixels:o,browser:s,browser_version:a}},mt=function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;return{navigation_id:e,name:t,duration:be(n)?Pe(n):0,transition_time:be(r)?Pe(r):0}},St={navigation_events:[],app_events:[],system_events:[],user_events:[],chunk_attributes:{},user_attributes:{},session_attributes:{}},_t=function(e){return{sdk_version:h,config_id:"apx",tick_interval:1,chunk_retry_window:1800,sdk_start_time:e}},bt=function(e,n,r){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;return Ze.debug("Model : Building the initial state of the Chunk"),{sdk_info:_t(e),session_info:{id:r,launch_time:n,launch_time_string:Ce(new Date(n)),startup_time:0,is_background:!1,is_first_session:!1,duration:0,total_duration:0,process_name:"",is_fatal:!1,launch_type:"normal"},app_info:{app_name:"",app_version:"ALL",bundle_id:"",installation_time:Nt.getInstance().getInstallationTime(Ee()),app_mode:"production"},device_info:xe(window),chunk_meta:{id:r+":"+i,number:i,reporting_times:[]},chunk_details:t(t({},St),{},{user_attributes:{},session_attributes:{}})}},wt=o(function e(){var t=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};r(this,e),s(this,"EBkV",function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2?arguments[2]:void 0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},o=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],s=t.window.XMLHttpRequest;Ze.debug("Request : POST request with data"),s?t.jjGZ(e,n,r,i,o):(Ze.error("Request : Unknown browser"),r(403,"Unknown")),Ze.debug("Request : Sent request to server")}),s(this,"get",function(e,n){var r=t.window,i=r.fetch,o=r.XMLHttpRequest;if(i)i(e).then(function(e){try{if(e.ok)return e.json()}catch(e){Ze.debug("Request : Error while parsing the response ".concat(e))}return null}).then(function(e){ve(e)?n(200,e):(Ze.error("Request : API request failed. ".concat(JSON.stringify(e))),n(500,{}))}).catch(function(e){Ze.error("Request : API request failed. ".concat(e)),n(500,e)});else if(o){var s=new o;s.open("GET",e,!0),s.onreadystatechange=function(){4===s.readyState&&n(s.status,s.responseText)},s.send()}else Ze.error("Request : Unknown browser"),n(403,"Unknown");Ze.debug("Request : sent request to server")}),s(this,"jjGZ",function(e,n,r,i,o){var s=new XMLHttpRequest;s.onerror=function(e){Ze.error("Request : API request failed. ".concat(e)),r(500,null)},s.open("POST",e,o),s.setRequestHeader("Content-Type","application/json; charset=UTF-8"),Object.keys(null!=i?i:{}).forEach(function(e){s.setRequestHeader(e,i[e])}),s.onreadystatechange=function(){if(4===s.readyState){var i=s.responseText,o=i.match(/Failed to execute 'send' on 'XMLHttpRequest'/);if(!(fe(o)||ge(o)||fe(o[0])||ge(o[0])||"Failed to execute 'send' on 'XMLHttpRequest'"!==o[0]))return void t.jjGZ(e,n,r,!0);try{i=JSON.parse(i)}catch(e){Ze.debug("Request : Error while parsing the response ".concat(e))}r(s.status,i)}};try{s.send(JSON.stringify(n))}catch(e){Ze.error("Request : API request failed. ".concat(e)),r(500,e)}}),this.window=n}),yt="/sdk/<app-id>/enabled-status?platform=web&version="+h,It=g.api_root,Dt=function(e,t){return It+e.replace("<app-id>",t)},Ct=o(function e(t){var n=this,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};r(this,e),s(this,"reua",function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:function(){return null},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){return null};return function(n,r){Ze.debug("XHR Response: [".concat(n,"]")),n<400?r&&"APXOR_STATUS_SUCCESS"===r.apxor_status?r.details?e(r.details):e(r):200===n?e(r):t(n,r):t&&me(t)&&t(n,r)}}),s(this,"AunS",function(e,t){n.makeGetRequest(n.sdkEnabledStatusAPI,e,t)}),s(this,"wZXz",function(e,t){n.makeGetRequest(n.configAPI,e,t)}),s(this,"Anzs",function(e,t,r){n.request.EBkV(n.userInfoAPI,e,n.reua(t,r),{})}),s(this,"HTKh",function(e,t,r){var i=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];Ze.debug("Posting chunk"),n.request.EBkV(n.chunksAPI,e,n.reua(t,r),{},i)}),s(this,"makeGetRequest",function(e,t,r){n.request.get(e,n.reua(t,r))}),s(this,"makePostRequest",function(e,t,r,i,o){n.request.EBkV(e,t,n.reua(i,o),r)}),this.request=new wt(i),this.configAPI=Dt("/config/<app-id>/web",t),this.chunksAPI=Dt("/<app-id>/chunks",t),this.sdkEnabledStatusAPI=Dt(yt,t),this.userInfoAPI=Dt("/user?appId=<app-id>",t)}),Et=o(function e(){var t=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;r(this,e),s(this,"KtOh",-1),s(this,"OXcT",0),s(this,"hgSy",function(){return t.OXcT}),s(this,"Xeow",function(){return t.KtOh}),s(this,"HmRi",function(){t.KtOh=-1,t.OXcT=0}),s(this,"NcTZ",function(e){if("FOREGROUND"===e.name){if(-1!==t.KtOh){var n=Math.round(Ne(Date.now()-t.KtOh));t.OXcT+=n;var r=Nt.getInstance().getFromStorage(ee);if(ve(r)&&Nt.getInstance().getSessionId()!==r){Nt.getInstance().TIsN();var i=Nt.getInstance().UzWR(),o=i.total_duration,s=i.duration;t.OXcT=o>s?o-s:0}}}else t.KtOh=Date.now(),Nt.getInstance().persistToStorage(J,t.KtOh)}),Nt.getInstance().registerForEvent(U,this._onSystemEvent),this.OXcT=n,Nt.getInstance().persistToStorage(J,this.KtOh)}),At=function(){function e(t){var n=this;r(this,e),s(this,"xZkG",!1),s(this,"DlHp",function(e){var t=!0;try{window[e]?(window[e].setItem("_apx_","apx"),"apx"!==window[e].getItem("_apx_")&&(t=!1),window[e].removeItem("_apx_")):t=!1}catch(e){t=!1}return t||Ze.error("Storage : LocalStorage not supported"),t}),s(this,"QTSc",function(e){Ze.error("".concat(n.storageType," Error: "),e)}),s(this,"get",function(e){try{return n.storage.getItem(e)}catch(t){Ze.error("Storage : Error while getting the ".concat(e," from storage - ").concat(t))}return null}),s(this,"aQBU",function(e){try{return JSON.parse(n.storage.getItem(e))}catch(t){Ze.error("Storage : Error while parsing ".concat(e,"'s value from storage - ").concat(t))}return null}),s(this,"set",function(e,t){try{n.storage.setItem(e,t)}catch(t){Ze.error("Storage : Error while setting the ".concat(e,"'s value to storage - ").concat(t))}}),s(this,"QZkq",function(e){try{n.storage.removeItem(e)}catch(t){Ze.error("Storage : Error while removing the ".concat(e," from storage - ").concat(t))}}),s(this,"clear",function(){try{n.storage.removeItem(R),n.storage.removeItem(N),n.storage.removeItem($),n.storage.removeItem(ee),n.storage.removeItem(P),n.storage.removeItem(F),n.storage.removeItem(z),n.storage.removeItem(M),n.storage.removeItem(J),n.storage.removeItem(te),n.storage.removeItem(ne),n.storage.removeItem(re),n.storage.removeItem(ie),n.storage.removeItem(oe),n.storage.removeItem(K),n.storage.removeItem(q),n.storage.removeItem(G),n.storage.removeItem(V)}catch(e){Ze.error("Storage : Error while clearing the storage - ".concat(e))}}),this.xZkG=this.DlHp(t),this.xZkG?(this.storage=window[t],this.storageType=t):(this.storageType=t,this.storage={length:0,getItem:function(){},setItem:function(){},removeItem:function(){},clear:function(){},get:function(){},set:function(){},remove:function(){},getParsed:function(){}})}return o(e,[{key:"isStorageAvailable",value:function(){return this.xZkG}}],[{key:"waitForBrowserStorage",value:function(t){var n=15,r=setInterval(function(){n--,e.isLocalStorageEnabled()||n<=0?(Ze.debug("Storage : Local storage available"),clearInterval(r),t()):Ze.debug("Storage : Local storage not available yet")},100)}},{key:"isLocalStorageEnabled",value:function(){try{var e="__apx_storage_test__";window.localStorage.setItem(e,"test");var t=window.localStorage.getItem(e);return window.localStorage.removeItem(e),"test"===t}catch(e){return Ze.debug("Browser storage is not enabled yet : ".concat(e)),!1}}}]),e}();var kt=function(){function e(n){var i=this;r(this,e),s(this,"qAWK",""),s(this,"cqLm",function(){var e,t=i.storage.get(R);if(ve(t))try{t=JSON.parse(je(i.qAWK,t))}catch(e){t=null}return null!==(e=t)&&void 0!==e?e:g}),s(this,"nEIh",function(e){i.storage.set(R,Be(i.qAWK,JSON.stringify(e)))}),s(this,"WGDU",function(e){i.storage.set(F,e)}),s(this,"VlLA",function(){var e=null;try{e=i.storage.get(F)}catch(e){Ze.debug("Datamaager : Can not get user id from storage-"+e)}return e}),s(this,"GztV",function(e){return i.storage.set(M,e)}),s(this,"EDYQ",function(){var e=i.storage.get(M);if(!ve(e)&&ue.isCookieAvailable()){var t=ue.get(M);if(ve(t))return i.storage.set(M,t),t}return e}),s(this,"fDMf",function(e,t){i.storage.set(e,t)}),s(this,"getItem",function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=i.storage.get(e);if(t){var r=Je(n);if(null===r)try{n=JSON.parse(je(i.qAWK,n))}catch(t){Ze.debug("Datamanager : ".concat(e," - value not found in storage")),n=null}else n=r}return Ze.debug("Datamanager : ".concat(e,"'s value from storage is ").concat(JSON.stringify(n))),n}),s(this,"pzhM",function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=i.getItem(e,n);return ve(r)?r:(Ze.debug("Datamanager : ".concat(e,"'s value is not defined. Returning default-").concat(JSON.stringify(t))),t)}),s(this,"ghKr",function(){i.storage.clear()}),s(this,"psaW",function(e){Ze.debug("DataManager : Setting the installation time to ".concat(e)),i.storage.set(z,e)}),s(this,"getInstallationTime",function(e){var t=i.storage.get(z);return ve(t)?(Ze.debug("Datamanager : Stored installation time ".concat(t)),Number(t)):(Ze.debug("Datamanager : Stored installation time not found. Persisting and returning the default time ".concat(e)),i.psaW(e),e)}),s(this,"Wivf",function(e){Ze.debug("Datamanager : Persisting the old session chunk to the storage"),i.storage.set(ne,Be(i.qAWK,JSON.stringify(e)))}),s(this,"UFmN",function(){var e;Ze.debug("Datamanager : Getting the old session chunk details form the storage");var t=i.storage.get(ne),n=Je(t);if(null===n)try{t=JSON.parse(je(i.qAWK,t))}catch(e){t=null}else t=n;return null!==(e=t)&&void 0!==e?e:[]}),s(this,"RPuG",function(){Ze.debug("Datamanager : Removing the old session chunk details form the storage"),i.storage.QZkq(ne)}),s(this,"vZQL",function(){return i.getItem(ie,!0)}),s(this,"DSvj",function(e){Ze.debug("Datamanager : Persisting the old session chunk details to the storage"),i.storage.set(ie,Be(i.qAWK,JSON.stringify(e)))}),s(this,"WXIp",function(){Ze.debug("Datamanager : Removing the old session chunk details form the storage"),i.storage.QZkq(ie)}),s(this,"vUkq",function(){Ze.debug("Datamanager : Getting the session chunknumber map");var e=i.getItem(oe,!0);return ve(e)||(e={}),e}),s(this,"hBDc",function(e){Ze.debug("Datamanager : Persisting the new session chunknumber map");var t=Be(i.qAWK,JSON.stringify(e));i.fDMf(oe,t)}),s(this,"NGVz",function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Date.now(),n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Date.now(),r=arguments.length>2?arguments[2]:void 0,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:3600;Ze.debug("Datamanager : Creating a new chunk");var s,a=!1,u=Number(i.storage.get($))||0,c=Date.now(),l=Math.round(Ne(c-u)),d=i.gbxF();if((l>o||pe(d))&&(a=!0),a)Ze.debug("Datamanager : This is a new session. Creating a new chunk"),s=bt(e,n,r);else{Ze.debug("Datamanager : This is an old session. Updating the existing chunk");var h=d.chunk_meta.number,g=d.session_info.id,f=h+1;(s=t({},d)).chunk_meta=t(t({},s.chunk_meta),{},{number:f,id:g+":"+f,reporting_times:[Date.now()]}),s.chunk_details=t({},St)}return{is_new_session:a,chunk:s}}),s(this,"pbGZ",function(){Ze.debug("Datamanager : Current chunk removed from storage"),i.storage.QZkq(te)}),s(this,"OrFc",function(e){Ze.debug("Datamanager : Persisting the Current chunk to storage"),i.storage.set(te,Be(i.qAWK,JSON.stringify(e)))}),s(this,"gbxF",function(){return i.getItem(te,!0)}),this.qAWK=n,this.storage=new At("localStorage"),Ze.debug("DataManager : Initialized")}return o(e,[{key:"getltCount",value:function(e){try{var t=this.storage.get(re);if(t){var n=je(this.qAWK,t);return JSON.parse(n)[e.replace("'","").replace("’","")]}}catch(t){Ze.error("Datamanager : Error gettting the LT Count for the event -"+e)}return 0}},{key:"updateRetainedDayCount",value:function(e){Ze.debug("Datamanager : Re-calculating and updating the retention day");var t=this.getItem(z),n=Math.abs(t-e)/36e5,r=Math.floor(n/24);this.fDMf("apx_retained_days",r)}}]),e}(),xt=["scroll","touchmove"],Ot=o(function e(){var t=this,n=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];r(this,e),s(this,"iFhz",!0),s(this,"TMEs",function(){Ze.debug("Registering for System Event ","visibilitychange");var e=function(){var e=Nt.getInstance(),n=e.getSDKRunningTimeInSec(),r=window.document.visibilityState===B,i=gt(window.document.visibilityState,n);if(r?(e.MeXG(!1),t.KtOh>-1&&(e.rMFL(function(){e.dispatchEvent(U,i)}),i.background_time=Pe(Ne(Date.now()-t.KtOh)))):(e.MeXG(!0),e.ltyZ(),t.KtOh=Date.now(),e.dispatchEvent(U,i)),r){var o=e.getUserAttributes().apx_browser;!t.iFhz||-1!==o.indexOf("Mobile Safari")&&-1!==o.indexOf("Safari")||(t.iFhz=!1)}else e.eWlz()};!function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];me(e.addEventListener)?e.addEventListener(t,n,r):me(e.attachEvent)?e.attachEvent(t,n):e["on"+t]=n}(document,"visibilitychange",e),t._handlers.push(t.iuYb("visibilitychange",e))}),s(this,"XDCk",function(){t._handlers.forEach(function(e){var t=e.type,n=e.handler;Ze.debug("Unregistering from event type ",t),xt.includes(t)?De(window.document,t,n):De(document,t,n)}),t._handlers=[],t._scrollEvents=[],t._scrollData={}}),s(this,"eFvg",function(){return[]}),s(this,"iuYb",function(e,t){return{type:e,handler:t}}),this.KtOh=-1,this._handlers=[],this._scrollEvents=[],this._scrollData={},this.iFhz=n,this.TMEs()}),Tt=o(function e(){var t=this;r(this,e),s(this,"CsUM",!0),s(this,"qAWK",""),s(this,"initialize",function(e,n){t.qAWK=n;var r=e.validate_hash,i=void 0===r||r,o=e.cs_ht_time,s=void 0===o?-1:o;t.CsUM=i,t.configsHashThrottleTime=s,Nt.getInstance().registerForEvent(X,function(e){t.tWzy(e.name)})}),s(this,"fetchConfiguration",function(e,n,r,i){if(me(i))if(t.CsUM){var o=Nt.getInstance();if(t.configsHashThrottleTime>0){var s=o.brHK(e+"_lcfht",-1);if(s>0)if(Math.abs(Date.now()-s)<t.configsHashThrottleTime)return void t.kDju(e,i)}o.persistToStorage(e+"_lcfht",Date.now());var a=t.ZBWS(),u={pid_mid:[]},c=a[e];if(ve(c)){Array.isArray(c)||(c=[c]);var l=[];c.forEach(function(e){var t=e.pid+"_"+e.mid;l.includes(t)||l.push(t)}),l.length>0&&(u.pid_mid=l.join(","))}else c=[];var d=o.getUserAttributes().custom_user_id,h=void 0===d?null:d;h&&(n+="&customerId="+h),o.makePostRequest(n,u,{"Content-Type":"application/json"},function(n){t.KOpF(n,e,r,{configs:c,syncData:a},i)},function(){Ze.error("Failed to fetch"),i(e,{configs:c})})}else t.lRqn(e,r,[],i)}),s(this,"ZBWS",function(){var e=Nt.getInstance().getFromStorage(P,!0);return ve(e)?e:{}}),s(this,"kDju",function(e,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=r;r||(i=t.ZBWS());var o=i[e];ve(o)&&(Array.isArray(o)||(o=[o]),Ze.debug("Reading from storage"),n(e,{configs:o}))}),s(this,"KOpF",function(e,n,r,i,o){var s=e.pull,a=void 0===s?[]:s,u=e.drop,c=void 0===u?[]:u,l=i.configs,d=i.syncData,h=JSON.parse(Nt.getInstance().getFromStorage(ae)),g=[];c.length>0||a.length>0?(l.forEach(function(e){c.includes(e.pid)||a.includes(e.pid)||g.push(e),c.includes(e.pid)&&null!==h&&null!=h&&h[e._id]&&(delete h[e._id],Nt.getInstance().persistToStorage(ae,JSON.stringify(h)))}),d[n]=g,Nt.getInstance().persistToStorage(P,Be(t.qAWK,JSON.stringify(d)))):(Ze.debug("Nothing to delete",n),g=l),a.length>0?(a.forEach(function(e){r+="&pids="+e}),t.lRqn(n,r,g,o)):(Ze.debug("Nothing to pull",n),o(n,{configs:g}))}),s(this,"lRqn",function(e,n,r,i){Nt.getInstance().makeGetRequest(n,function(n){if(ve(n.configs)&&Array.isArray(n.configs)&&0==n.configs.length)i("",{configs:[]});else if(ve(n.configs)&&Array.isArray(n.configs)){var o=t.ZBWS(),s=[].concat(u(r),u(n.configs));o[e]=s,Nt.getInstance().persistToStorage(P,Be(t.qAWK,JSON.stringify(o))),i(e,{configs:s})}},function(){i(e,{configs:[]})})}),s(this,"YfLm",function(e){t.tWzy(e)}),s(this,"tWzy",function(e){var n=t.ZBWS();if(ve(n.d)||(n.d={}),JSON.stringify(n.d).length>2097152)Ze.error("Sync : Reached maximum limit. Can't store further");else{var r=0;ve(n.d[e])&&(r=n.d[e]),r+=1,n.d[e]=r,Nt.getInstance().persistToStorage(P,Be(t.qAWK,JSON.stringify(n)))}}),s(this,"getEventCount",function(e){var n=t.ZBWS();return ve(n.d)&&ve(n.d[e])?n.d[e]:0})}),Ft=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return function(){Ze.error("".concat(e,": Apxor SDK not initialised."))}},Rt={reportChunkOnVisibilityChange:Ft("ltyZ"),logAppEvent:Ft("cLkC"),logClientEvent:Ft("logClientEvent"),logPageView:Ft("logPageView"),setUserId:Ft("setUserId"),setUserProperties:Ft("setUserProperties"),setSessionProperties:Ft("setSessionProperties"),setAppVersion:Ft("setAppVersion"),getClientId:Ft("getClientId"),getSessionId:Ft("getSessionId"),startSession:Ft("startSession"),endSession:Ft("endSession"),flattenJSON:Ft("flattenJSON"),setRedirectionHandler:Ft("setRedirectionHandler"),setInitFlag:Ft("setInitFlag")},Nt=function(){function e(){var n=this;return r(this,e),s(this,"fsyo",{}),s(this,"RDGE",!1),s(this,"YZQY",{}),s(this,"hfHH",{}),s(this,"BAhJ",{}),s(this,"ICqj",{}),s(this,"zbDr",{}),s(this,"pmAO",{}),s(this,"wrFI",{}),s(this,"WEKV",1),s(this,"ldpH",null),s(this,"SdaH",!1),s(this,"AXrk",!1),s(this,"cVSh",{}),s(this,"FJLm",{}),s(this,"qznS",{}),s(this,"theN",{}),s(this,"aPFY",3600),s(this,"ifnX",20),s(this,"XDUg",-1),s(this,"xGmr",2e4),s(this,"TzWY",-1),s(this,"XLlY",10),s(this,"ExvA",!1),s(this,"Okrb",!1),s(this,"rVaX",-1),s(this,"PVFr",!1),s(this,"Ktus",!0),s(this,"clientEvents",[]),s(this,"SOXv",[]),s(this,"DXit",[]),s(this,"jtgf",[]),s(this,"VlrV",{}),s(this,"uUdB",0),s(this,"ERiy",null),s(this,"EoNB",null),s(this,"eCrj",null),s(this,"orPc",!1),s(this,"VLIL",!1),s(this,"qIzs",{}),s(this,"initWaitTime",1500),s(this,"version",""),s(this,"ojWI",""),s(this,"BMtw",""),s(this,"sessionStartTime",null),s(this,"sessionId",""),s(this,"xzUG",{}),s(this,"comS",function(e){var t=n.config.plugins;if(ve(t)&&ve(t.length))for(var r=0;r<t.length;r++){var i=t[r];try{var o;null===(o=window[i])||void 0===o||o.init(e),Ze.debug("Controller : Initialized plugin ".concat(i))}catch(e){Ze.error("Controller : Failed to initialize plugin ".concat(i," with error ").concat(e))}}}),s(this,"initialize",function(e,t,r,i,o,s){if(!n.RDGE){var a=function(){Ze.debug("Controller : On Site enabled in config"),n.Vyil(u,s)},u=function(e){n.BMtw=e,Ze.debug("Controller : On config hash fetch"),n.ciKc(e,c)},c=function(){Ze.info("Controller : Waiting for resources completed"),n.zRvj(),n.RLEw(),n.ZKHi(),n.ojWI=n.cVZS(),n.ywPq(),n.TgBA(),n.XKMk(),n.gVPs(),n.nbrW(),n.YRzV(),n.FIFf(),n.JZEc(n.BMtw);var e=n.MpkJ();n.qznS=new Et(e),n.xCVT(),n.rMFL(l)},l=function(){n.SdaH=!0,n.RDGE=!0;var e=n.TIsN();n.cVSh.OrFc(e),n.comS(d)},d=function(){n.gcQW(n.window.document.visibilityState),n.newSession&&(n.sessionStartTime=Date.now(),n.cLkC(L,{time:Ce(new Date)}),n.GxYA()),n.logPageView(n.window.location.pathname),n.KexD(),n.ULIS(),o()};n.JWGl(function(){Ze.debug("Controller : Wait for browser storage completed."),n.dzut(e,t,r,i),n.DnNc(),n.FyVr(),n.theN.initialize(n.config,n.siteId),n.fJTK(a,s)})}}),s(this,"getSiteId",function(){return n.siteId}),s(this,"setRedirectionHandler",function(e){n.RDGE?n.ERiy?n.ERiy=e:(n.ERiy=e,n.registerForEvent("CLIENT_EVENT",n.QcJx)):Rt.setRedirectionHandler()}),s(this,"QcJx",function(e){e&&"REDIRECT"===e.name&&n.ERiy(e.additional_info.url)}),s(this,"makePostRequest",function(e,t,r,i,o){n._api.makePostRequest(e,t,r,i,o)}),s(this,"getDevInfo",function(){return n.hfHH}),s(this,"AmaO",function(){return n.qIzs}),s(this,"GhZC",function(e,r){n.qIzs[e]=n.qIzs[e]||{},n.qIzs[e]=t(t({},n.qIzs[e]),r)}),s(this,"getInstallationTime",function(){return n.cVSh.getInstallationTime(n.startTime)}),s(this,"JWGl",function(e){Ze.debug("Controller : Checking if the browsers localstorage is available."),At.waitForBrowserStorage(e)}),s(this,"dzut",function(e,t,r,i){Ze.debug("Controller : Initializing the state variables"),n.window=i,n.startTime=t,n.siteId=e,n.clientConfig=r||{},n.initWaitTime=n.clientConfig.sdk_init_wait?1e3*n.clientConfig.sdk_init_wait:2e3,n._api=new Ct(n.siteId,n.window),n.cVSh=new kt(n.siteId),n.fsyo=new ht,n.theN=new Tt,n.BAhJ=_t(n.startTime),n.sessionStartTime=n.cVSh.pzhM(se,t),Ze.debug("Controller : session start time is ".concat(n.sessionStartTime)),Ze.debug("Controller : SDK start time is ".concat(n.startTime)),n.sessionId=n.getFromStorage(ee)}),s(this,"RLEw",function(){Ze.debug("Controller : Initializing the LT Count ");try{var e=n.getFromStorage(re);if(e)n.xzUG=JSON.parse(je(n.siteId,e));else{n.xzUG={};var t=Be(n.siteId,JSON.stringify(n.xzUG));n.persistToStorage(re,t)}}catch(e){Ze.error("Controller : LT Count object parsing failed ".concat(e))}}),s(this,"zRvj",function(){var e=new URLSearchParams(location.search),t=e.get("_a")||e.get("_p")||e.get("_x")||e.get("_o")||e.get("_r");if(t||(t=n.getFromStorage("_apxor_url_param")),t)try{Ze.debug("Controller : Initialising in WYSIWYG mode");var r=je(n.siteId,t),i=r=JSON.parse(r),o=i.app_id,s=i.expiry,a=Date.now();if(o===n.siteId&&a<=s){var u=new Date(s+6e4).toUTCString(),c=btoa("_apx_ew");document.cookie="_apx_ewc=".concat(c,"; expires=").concat(u),r.expiry=r.expiry+6e4,n.persistToStorage("_apx_ew",r,!0),Ze.debug("Controller : _apx_ewc cookie set")}e.delete("_a"),e.delete("_p"),e.delete("_x"),e.delete("_o"),e.delete("_r");var l=location.pathname,d=e.toString();""!==d&&(l+="?"+d),n.window.history.replaceState({},document.title,l),Ze.debug("Controller : Query params reset after removing dashboard embedded params")}catch(e){Ze.error("Controller : Error while setting the WYSIWYG cookie ".concat(e))}else Ze.debug("Controller : Not in WYSIWYG mode")}),s(this,"DnNc",function(){Ze.debug("Controller : Setting the config");var e=n.cVSh.cqLm();n.aieo(e)}),s(this,"aieo",function(e){n.config=t(t({},e),n.clientConfig),Ze.debug("Controller : New config and client configs Configs merged")}),s(this,"FyVr",function(){var e,t,r,i=n.config,o=i.version,s=void 0===o?"":o,a=i.bulk_upload,u=void 0===a||a,c=i.events_upload_time,l=i.idle_time_out,d=void 0===l?1800:l,h=i.events,g=void 0===h?{}:h,f=i.max_chunk_event_count,v=void 0===f?20:f,p=i.retry_time,m=i.max_sessions_in_storage,S=void 0===m?-1:m;n.version=n.PPZd(s),n.Ktus=u,n.PVFr=c>0,n.aPFY=be(d)?d:1800,n.SOXv=null!==(e=g.stop)&&void 0!==e?e:[],n.DXit=null!==(t=g.action)&&void 0!==t?t:[],n.jtgf=null!==(r=g.app)&&void 0!==r?r:[],n.ifnX=ve(v)&&be(v)?v:20,n.XDUg=ve(c)&&be(c)&&c>=1e3?c:-1,n.TzWY=ve(p)&&be(p)&&p>=1e3?p:-1,n.XLlY=be(S)&&S>0?S:-1}),s(this,"PPZd",function(e){var t;if(ve(e))t=e,n.cVSh.GztV(t);else{var r=n.cVSh.EDYQ();t=ve(r)?r:""}return t}),s(this,"fJTK",function(e,t){if(Ze.debug("Controller : Checking if the Site is enabled existing config"),!n.config.enable)return Ze.debug("Controller : Site is disabled. Can't initialise"),n.JZEc(""),n.XKMk(),void t();e()}),s(this,"Vyil",function(e,t){var r=n.cVSh.cqLm(),i=n.cVSh.pzhM(V,-1),o=r.ed_t_time;if(o>0&&i>0&&Math.abs(i-Date.now())<60*o*1e3)return Ze.debug("Controller : Reinitializing with in the throttling time."),n.cVSh.pzhM(G,!0)?void e(n.cVSh.pzhM(q,"")):(Ze.debug("Controller : Site is not enabled from the last update. Can't initalise now. Recheck will happen after throttling time"),void t());n.LNYL(e,t)}),s(this,"LNYL",function(e,t){Ze.debug("Controller : Getting the site enabled status from the server"),n.persistToStorage(V,Date.now()),n._api.AunS(function(r){var i=r.enabled,o=r.hash;n.persistToStorage(G,i),i?(Ze.debug("Controller : Site is enabled"),e(o)):(Ze.debug("Controller : Site is disabled. Can't initialise the SDK"),n.RDGE=!1,n.SdaH=!1,n.dMEM(),t())},function(e){Ze.error("Controller : enabled-status API failed ".concat(e))})}),s(this,"dMEM",function(){Ze.debug("Controller: Stopping the SDK");try{var e,t;n.SdaH=!1,n.RDGE=!1,n.ExvA=!1,null===(e=n.fsyo)||void 0===e||e.RmyJ(),null===(t=n.FJLm)||void 0===t||t.XDCk()}catch(e){Ze.error("Controller : Failed to stop the SDK ".concat(e))}}),s(this,"ciKc",function(e,t){Ze.debug("Controller: Waiting ".concat(n.initWaitTime,"ms for all the resource loading to finish")),setTimeout(function(){t(e)},n.initWaitTime)}),s(this,"cVZS",function(){var e=n.cVSh.VlLA();if(!ve(e)){Ze.debug("Controller : Device id not found in localstorage");var t=n.config.client_id;ve(t)&&""!==t?(Ze.debug("Controller : client id from clientconfig is the deviceid"),e=t):(Ze.debug("Controller : Generated a new device id. This is a new device now"),e=Ae()),n.dGFA(e)}return Ze.debug("Controller : Device id is ".concat(e)),n.ojWI=e,e}),s(this,"dGFA",function(e){n.cVSh.ghKr(),n.cVSh.WGDU(e),n.cVSh.psaW(Date.now()),n.ICqj=t(t({},n.ICqj),{},{is_first_session:!0}),n.Okrb=!0}),s(this,"YRzV",function(){Ze.debug("Controller : Setting the session state for session if ".concat(n.sessionId)),n.sessionId||(n.newSession=!0,n.sessionId=Ae(),n.persistToStorage(ee,n.sessionId),n.persistToStorage(se,n.sessionStartTime))}),s(this,"ywPq",function(){var e=xe(n.window),t=e.device,r=e.os,i=e.browser_version,o=e.browser,s=e.dimensions,a=e.dpi,u=e.dimensions_in_pixels;n.hfHH=pt(n.ojWI,t,s,r,a,u,o,i)}),s(this,"TgBA",function(){Ze.debug("Controller : Setting the default User attributes");var e=t({},n.hfHH),r=Oe(n.window,e);n.zbDr=t(t({},n.zbDr),r)}),s(this,"nbrW",function(){Ze.debug("Controller : Setting the default session attributes");var e=Te(n.window);n.pmAO=t(t({},n.pmAO),e)}),s(this,"gVPs",function(){Ze.debug("Controller : Merging the stored and default user attributes");var e=n.getFromStorage(N,!0);if(ve(e)){var r,i=Je(e);if(null===i)try{i=JSON.parse(je(n.siteId,e))}catch(e){i={}}n.zbDr=t(t({},n.zbDr),null!==(r=i)&&void 0!==r?r:{})}}),s(this,"FIFf",function(){n.wrFI=t(t({},St),{},{user_attributes:t({},n.zbDr),session_attributes:t({},n.pmAO)}),n.cVSh.DSvj(n.wrFI)}),s(this,"rMFL",function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:function(){};Ze.debug("Controller : Sending the old chunk to the server");var r=n.cVSh.UFmN();if(ve(r)){var i,o,s,a,u,c,l,d,h,g,f=t({},n.wrFI);if(n.wrFI=t({},r.chunk_details)||{},(null===(i=n.wrFI)||void 0===i?void 0:null===(o=i.app_events)||void 0===o?void 0:o.length)>0||n.WNsR(),!((null===(s=n.wrFI)||void 0===s?void 0:null===(a=s.app_events)||void 0===a?void 0:a.length)>0))return n.wrFI=t({},f),void e();var v=null!==(u=null===(c=r=t(t({},r),{},{chunk_details:t({},n.wrFI)}))||void 0===c?void 0:null===(l=c.session_info)||void 0===l?void 0:l.id)&&void 0!==u?u:"1",p=null!==(d=null===(h=r)||void 0===h?void 0:null===(g=h.chunk_meta)||void 0===g?void 0:g.number)&&void 0!==d?d:1;n.cVSh.OrFc(r),n._api.HTKh(r,function(){n.zkHS(v,p+1),Ze.debug("Controller : Old chunk reporting successful."),n.cVSh.RPuG(),n.cVSh.WXIp(),n.FIFf(),n.cDXP(),e()},function(){Ze.debug("Controller : Old chunk reporting failed."),e()})}else e()}),s(this,"WNsR",function(){var e=n.cVSh.vZQL();if(ve(e)){var t=e.app_events,r=e.navigation_events,i=e.system_events,o=e.user_events;n.wrFI.app_events=[].concat(u(n.wrFI.app_events||[]),u(t)),n.wrFI.navigation_events=[].concat(u(n.wrFI.navigation_events||[]),u(r)),n.wrFI.system_events=[].concat(u(n.wrFI.system_events||[]),u(i)),n.wrFI.user_events=[].concat(u(n.wrFI.user_events||[]),u(o)),n.cVSh.WXIp()}}),s(this,"zkHS",function(e,t){var r=n.cVSh.vUkq();r[e]=t,n.cVSh.hBDc(r),n.WEKV=t}),s(this,"cDXP",function(){var e=n.TIsN();return n.cVSh.OrFc(e),e}),s(this,"TIsN",function(){var e=ve(n.config.name)?n.config.name:"",r=ve(n.config.domain)?n.config.domain:"",i=n.cVSh.NGVz(n.startTime,n.sessionStartTime,n.sessionId,n.aPFY),o=i.chunk,s=o.session_info,a=o.app_info,u=o.sdk_info,c=o.chunk_details,l=o.chunk_meta,d=c.session_attributes,h=c.user_attributes;return n.ICqj=s,n.ICqj.is_first_session=n.Okrb,n.BAhJ=u,n.YZQY=t(t({},a),{},{app_name:e,bundle_id:r,app_version:n.version}),n.WEKV=l.number,n.zbDr=t(t({},n.zbDr),h),n.pmAO=t(t({},n.pmAO),d),n.wrFI=c,n.WNsR(),n.newSession=i.is_new_session,n.newSession||n.aAtt(o),{sdk_info:n.BAhJ,session_info:n.ICqj,app_info:n.YZQY,device_info:n.hfHH,chunk_details:c,chunk_meta:l}}),s(this,"aAtt",function(e){var t=e.session_info.id;t&&(n.sessionId=t,n.persistToStorage(ee,n.sessionId))}),s(this,"MpkJ",function(){var e=n.ICqj,t=e.total_duration,r=e.duration;return t>r?t-r:0}),s(this,"JZEc",function(e){if(Ze.debug("Controller : Fetch a new config"),n.dwbG(e)){var t=n.config.sct_time,r=n.cVSh.pzhM(K,-1);if(t>0&&r>0)if(Math.abs(Date.now()-r)<t)return void Ze.debug("Controller : No need to fetch config. Did not pass the throttle time");n.persistToStorage(K,Date.now()),n._api.wZXz(function(e){var t;Ze.debug("Controller : New config fetched"),n.cVSh.nEIh(e),n.persistToStorage(q,null!==(t=e.hash)&&void 0!==t?t:dt(e)),n.aieo(e),n.ZKHi()},function(e){0!==e&&Ze.error("Controller : Failed to fetch config")})}else Ze.debug("Controller : No need to fetch config. No change in hash")}),s(this,"XKMk",function(){Ze.debug("Controller : Posting user info");var e=n.BAhJ.sdk_version,t={sdk_version:JSON.stringify(e),app_info:n.YZQY,device_info:n.hfHH,user_attributes:n.zbDr},r=dt(t),i=n.cVSh.pzhM(W,"");r!==i?n._api.Anzs(t,function(){Ze.debug("Controller : Posted user info. Persisting the hash to localstorage"),n.persistToStorage(W,r)}):Ze.debug("Controller : No need to post user info. No change in it")}),s(this,"dwbG",function(e){return""===e||n.cVSh.pzhM(q,"")!==e}),s(this,"gcQW",function(e){Ze.debug("Controller : Dispatching SYSTEM_EVENT");var t=gt(e,n.hrJM());n.dispatchEvent(U,t)}),s(this,"GxYA",function(){Ze.debug("Controller : Resetting the session frequncy of all the campaigns to 0");var e={};try{var t=n.getFromStorage(Q);ve(t)&&(e=JSON.parse(je(n.siteId,t))),Object.entries(e).forEach(function(t){var n=a(t,1)[0];return e[n].SESSION=0})}catch(t){e={},Ze.error("Controller : Can't reset campaign limits:".concat(t))}n.persistToStorage(Q,e,!0),n.window.ApxorRTM.resetFrequencyCounts()}),s(this,"xCVT",function(){Ze.debug("Registering a handler for the system events"),we(n.window,function(){n.AXrk||(n.XGyN(),n.FJLm=new Ot(!1),n.AXrk=!0)})}),s(this,"XGyN",function(){var e=!1;ye(window,function(){(Ze.debug("Controller : Executing before unload"),e)||n.SdaH&&(e=!0,window.document.visibilityState===B&&(n.tehW(!0),n.gcQW("hidden")),clearInterval(n.EoNB),clearInterval(n.eCrj),n.Ktus&&n.cVSh.DSvj(n.wrFI),n.FJLm.XDCk())})}),s(this,"ULIS",function(){Ze.debug("Controller : Registering the handlers for chunk reporting"),clearInterval(n.eCrj),n.eCrj=setInterval(function(){n.KexD()},n.xGmr),n.PVFr&&(clearInterval(n.EoNB),n.EoNB=setInterval(function(){n.BOfB()},n.XDUg))}),s(this,"KexD",function(){var e=n.wrFI,t=e.app_events,r=e.navigation_events;t.length+r.length>0&&!n.orPc&&n.XRRG()}),s(this,"BOfB",function(){var e=n.wrFI,t=e.app_events,r=e.navigation_events,i=t.length+r.length;(!n.Ktus&&i>0||n.Ktus&&i>=n.ifnX)&&n.XRRG()}),s(this,"XRRG",function(){Ze.debug("Controller : Preparing and reporting chunk");var e=n.FYSx(n.wrFI);n.aiDx(e,!1)}),s(this,"FYSx",function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Ze.debug("Controller : Preparing chunk"),n.PJzx();var r={id:n.sessionId+":"+n.WEKV,number:n.WEKV,reporting_times:[Date.now()]};return e=t(t({},e),{},{user_attributes:n.zbDr,session_attributes:n.pmAO}),{sdk_info:n.BAhJ,session_info:n.ICqj,app_info:n.YZQY,device_info:n.hfHH,chunk_meta:r,chunk_details:e}}),s(this,"PJzx",function(){Ze.debug("Controller : Updating the foreground time");var e=n.getSDKRunningTimeInSec(),r=e;e-=n.qznS.hgSy(),n.ICqj=t(t({},n.ICqj),{},{duration:Pe(e),total_duration:Pe(r)})}),s(this,"aiDx",function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){};if(Ze.debug("Controller : Reporting chunk"),n.ExvA||n.TzWY>0&&-1!==n.rVaX&&Date.now()-n.rVaX<n.TzWY)n.FIFf();else{var i=e.chunk_details,o=i.app_events,s=i.system_events,a=i.navigation_events,u=i.user_events;if(o.length<1&&s.length<1&&a.length<1&&u.length<1)return Ze.debug("Controller : Chunk not sent. No events in the chunk"),n.ExvA=!1,void r();n.ExvA=!0,n.zkHS(n.ICqj.id,n.WEKV+1),n.cVSh.WXIp(),n.cVSh.RPuG(),n.FIFf(),t?(n.ExvA=!1,n.cVSh.Wivf(e),r()):(n.cVSh.OrFc(e),n._api.HTKh(e,function(){Ze.debug("Controller : Chunk successfully sent"),n.ExvA=!1,n.rVaX=-1,r()},function(t){Ze.debug("Controller : Chunk sending failed"),0!==t&&(n.ExvA=!1,t>=500&&(n.rVaX=Date.now()),413!==t&&417!==t&&n.cVSh.Wivf(e),r())}))}}),s(this,"setUserId",function(e){n.RDGE?n.SdaH?ge(e)||(Ze.debug("Controller : User id set"),n.setUserProperties({custom_user_id:e})):Ze.warn("Apxor SDK is not running"):Rt.setUserId()}),s(this,"setUserProperties",function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(n.RDGE)if(n.SdaH){if(Object.keys(e).length>0){n.zbDr=t(t({},n.zbDr),e);try{Ze.debug("Controller : User properties set"),n.persistToStorage(N,Be(n.siteId,JSON.stringify(n.zbDr)))}catch(e){Ze.debug("Controller : Error while setting the use properties ".concat(e))}}}else Ze.warn("Apxor SDK is not running");else Rt.setUserProperties()}),s(this,"setSessionProperties",function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};n.RDGE?n.SdaH?Object.keys(e).length>0&&(Ze.debug("Controller : Session properties set"),n.pmAO=t(t({},n.pmAO),e)):Ze.warn("Apxor SDK is not running"):Rt.setSessionProperties()}),s(this,"setAppVersion",function(e){n.RDGE?n.SdaH?n.version=e:Ze.warn("Apxor SDK is not running"):Rt.setAppVersion()}),s(this,"ZKHi",function(){Ze.debug("Controller : Updating the App info");var e=n.config,t=e.name,r=void 0===t?"":t,i=e.domain,o=void 0===i?n.window.location.host:i,s=n.cVSh.getInstallationTime(n.startTime),a=Ve(n.window),u=ve(n.clientConfig.version)?""+n.clientConfig.version:n.cVSh.EDYQ(),c=r;""===r&&"Unknown"===(c=Re(n.window))&&(c=""),n.YZQY=vt(c,o,s,a,u)}),s(this,"getEventCount",function(e){var t=-1;return n.clientEvents.forEach(function(n){n.name===e&&(t+=1)}),-1===t?n.theN.getEventCount(e):t}),s(this,"eWlz",function(){n.tehW(),n.ldpH=null}),s(this,"tehW",function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];Ze.debug("Controller : Ending the navigation"),ve(n.ldpH)&&(n.ldpH.duration=Pe(n.getSDKRunningTimeInSec()-n.ldpH.transition_time),n.dispatchEvent(H,t({},n.ldpH),e))}),s(this,"getSessionId",function(){return n.sessionId}),s(this,"EBLZ",function(){return n.RDGE?n.SdaH?n.ojWI:(Ze.warn("Controller : Apxor SDK is not running"),null):(Rt.getClientId(),null)}),s(this,"ltyZ",function(){var e;if(n.RDGE){var t=n.FYSx(n.wrFI),r=n.siteId,i=JSON.stringify(t);(null===(e=n.wrFI)||void 0===e?void 0:e.app_events.length)>0&&(Ze.debug("Reporting a chunk on visibility change with sendBeacon"),n.cVSh.WXIp(),n.cVSh.Wivf(t),navigator.sendBeacon("https://server.apxor.com/v2/api/".concat(r,"/text-chunks?appId=").concat(r),i))}}),s(this,"CFtt",function(e){if(pe(n.xzUG[e])&&0!==n.xzUG[e])n.xzUG[e]=0;else{var t=n.xzUG[e];t+=1,n.xzUG[e]=t}var r=Be(n.siteId,JSON.stringify(n.xzUG));n.persistToStorage(re,r)}),s(this,"cLkC",function(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=arguments.length>2?arguments[2]:void 0,o=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(!n.RDGE||!n.SdaH)return Ze.warn("Controller : Can't log App event. SDK not initialised"),void Rt.cLkC();try{if(Se(e)&&Ge(r)){var s=e.replace("'","").replace("’","");n.CFtt(s);var a=n.xzUG[s]||0;r=t(t({},r),{},{apx_lt_count:a});var u=ft(e,qe(r),i,n.hrJM()),c=X;if(n.SOXv.includes(e))return;n.DXit.includes(e)&&(c=Y),Ze.debug("Controller : Logging event ".concat(e)),n.GhZC(e,r),n.dispatchEvent(c,u,!1,o)}else Ze.debug("Controller : Invalid App Event ".concat(e))}catch(e){Ze.error("LT Count object parsing failed ".concat(e))}}),s(this,"logClientEvent",function(e,r){if(!n.RDGE||!n.SdaH)return Ze.warn("Controller : Can't log client event. SDK not initialised"),void Rt.logClientEvent();var i=n.cVSh.getltCount(e);r=t(t({},r),{},{apx_lt_count:i});var o=ft(e,qe(r),null,n.hrJM()),s=Y;n.SOXv.includes(e)||(n.jtgf.includes(e)&&(s=X),o?(Ze.debug("Controller : Logging client event ".concat(e)),n.GhZC(e,r),n.dispatchEvent(s,o)):Ze.debug("Controller : Invalid client event ".concat(e)))}),s(this,"logPageView",function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:n.hrJM();if(!n.RDGE||!n.SdaH)return Ze.warn("Controller : Can't log page event. SDK not initialised"),void Rt.logPageView();if("string"==typeof e&&e&&e.length>0){var r=Pe(t),i=mt(e,Re(n.window),0,r);n.theN.YfLm(e),ve(n.ldpH)?(n.tehW(),n.ldpH=i):n.ldpH=i,n.cLkC(j,{time:Ce(new Date),navigation_id:e}),Ze.debug("logPageView: page view is logged ",e)}else Ze.warn("Controller : Can't log page event as pathname is empty")}),s(this,"dispatchEvent",function(e,r){var i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=arguments.length>3&&void 0!==arguments[3]&&arguments[3];Ze.debug("Controller : Dispatching Event ".concat(r.name)),n.cVSh.updateRetainedDayCount(Date.now());var s=!1,a=function(){var a=n.wrFI.app_events;switch(s&&(r.time=n.hrJM()),e){case X:n.wrFI=t(t({},n.wrFI),{},{app_events:[].concat(a,r)});break;case Y:n.clientEvents.push(r)}if(n.fsyo.uNpK(e,r),!s&&e!==Y){n.wrFI=t(t({},n.wrFI),{},{user_attributes:t({},n.zbDr),session_attributes:t({},n.pmAO)});var u=n.FYSx(n.wrFI,e);if(n.cVSh.DSvj(n.wrFI),n.cVSh.Wivf(u),!0!==o)if(n.Ktus){if(a.length+1<n.ifnX)return;n.aiDx(u,i)}else i||e!==X||n.PVFr||n.aiDx(u,i);else n.aiDx(u,i)}},u=function(){n.persistToStorage($,Date.now()),a()};if(e===X){var c=Date.now(),l=n.getFromStorage($);l=Number(l),be(l)&&l>0&&Math.round(Ne(c-l))>n.aPFY?n.endSession(!0,function(){s=!0,n.startNewSession(Date.now(),u)}):(n.persistToStorage($,Date.now()),a())}else a()}),s(this,"startNewSession",function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Date.now(),r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){},i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];n.RDGE||i?n.SdaH?r():(n.sessionId=Ae(),Ze.debug("Controller : New session started with id ".concat(n.sessionId)),n.persistToStorage(ee,n.sessionId),n.uUdB=null!==(e=n.getFromStorage(Z))&&void 0!==e?e:0,n.uUdB=Number(n.uUdB)+1,n.persistToStorage(Z,n.uUdB),n.sessionStartTime=t,n.persistToStorage(se,n.sessionStartTime),n.qznS.HmRi(),n.cDXP(),n.FJLm=new Ot(n.config),n.SdaH=!0,n.GxYA(),r()):Rt.startSession()}),s(this,"endSession",function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){};if(n.RDGE)if(n.SdaH){e||n.tehW();var i=t(t({},n.wrFI),{},{user_attributes:t({},n.zbDr),session_attributes:t({},n.pmAO)}),o=n.FYSx(i);n.cVSh.WXIp();var s=function(){n.cVSh.pbGZ(),n.qznS.HmRi(),ve(n.FJLm)&&n.AXrk&&n.FJLm.XDCk(),Ie(document),n.SdaH=!1,r(),Ze.debug("Controller : Current session ended")};n.TzWY>0&&n.rVaX>0?(n.cVSh.Wivf(o),s()):n.aiDx(o,!1,s)}else Ze.warn("Apxor SDK is not running. Please make sure to call 'startSession'");else Rt.endSession()}),s(this,"persistToStorage",function(e,t){var r=t;arguments.length>2&&void 0!==arguments[2]&&arguments[2]&&Ge(r)&&(r=Be(n.siteId,JSON.stringify(r))),n.cVSh.fDMf(e,r)}),s(this,"getFromStorage",function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return n.cVSh.getItem(e,t)}),s(this,"brHK",function(e,t){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return n.cVSh.pzhM(e,t,r)}),s(this,"UzWR",function(){return n.ICqj}),s(this,"getUserAttributes",function(){return n.zbDr}),s(this,"getSessionAttributes",function(){return n.pmAO}),s(this,"makeGetRequest",function(e,t,r){n._api.makeGetRequest(e,t,r)}),s(this,"fetchConfiguration",function(e,t,r,i){n.theN.fetchConfiguration(e,t,r,i)}),s(this,"flattenJSON",function(e){return qe(e,2)}),s(this,"registerForEvent",function(e,t){n.fsyo.registerForEvent(e,t)}),s(this,"unregisterFromEvent",function(e,t){n.fsyo.unregisterFromEvent(e,t)}),s(this,"getSDKRunningTimeInSec",function(){return Ne(Date.now()-n.startTime)}),s(this,"hrJM",function(){var e=Date.now();return Ze.debug("Controller : Time elapsed in session is ".concat((e-n.sessionStartTime)/1e3,"sec")),Ne(e-n.sessionStartTime)}),s(this,"MeXG",function(e){n.orPc=e}),s(this,"omup",function(e){null===n.getFromStorage(ae)&&n.persistToStorage(ae,JSON.stringify({}));var t=JSON.parse(n.getFromStorage(ae));t[e]||(t[e]={goalAcheived:!0},n.persistToStorage(ae,JSON.stringify(t)))}),e.instance||(e.instance=this),e.instance}return o(e,null,[{key:"getInstance",value:function(){return e.instance||(e.instance=new e),e.instance}}]),e}();s(Nt,"instance",void 0);var Pt=function(){function e(t){var n=this,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Ee();r(this,e),s(this,"RDGE",!1),s(this,"Bwav",[]),s(this,"version",202),s(this,"Ysgk",!1),s(this,"gZTe",null),s(this,"Sdrv",function(){Array.isArray(n._q)&&n._q.forEach(function(e){var t=e.m,r=e.args;n[t]&&me(n[t])&&n[t].apply(n,Array.from(r))})}),s(this,"init",function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:f,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;try{if(Ze.debug("SDK : Apxor SDK initialization has started"),!n.RDGE){var o,s,a,u;ve(t)&&(!ve(t)||t instanceof Object)||(t=f);var c=t,l=c.honorDNT,d=void 0!==l&&l,g=c.debug,v=void 0!==g&&g,p=c.events_upload_time,m=void 0===p?-1:p,S=c.retry_time,_=void 0===S?-1:S,b=c.level,w=void 0===b?"error":b;if(null!==(o=n.window)&&void 0!==o&&null!==(s=o.localStorage)&&void 0!==s&&s.getItem("apx_debug_enable")&&(v="true"===n.window.localStorage.getItem("apx_debug_enable")),null!==(a=n.window)&&void 0!==a&&null!==(u=a.localStorage)&&void 0!==u&&u.getItem("apx_log_level")&&(w=n.window.localStorage.getItem("apx_log_level")),n.eESb(v,w),!ve(e)||!ve(e.trim)||""===e.trim())return Ze.error("SDK : ApxorSDK couldn't be initialized: Invalid Site Id:".concat(e)),n._controller=Rt,void(null!=i&&me(i)&&i());if(d&&!Fe(n.window))return n._controller=Rt,null!=i&&me(i)&&i(),void Ze.error("SDK : Tracking is disabled, ApxorSDK couldn't be initialized");n._controller=Nt.getInstance(),ve(m)&&m>0&&(t.events_upload_time*=1e3),ve(_)&&_>0&&(t.retry_time*=1e3),n._controller.initialize(e,n._startTime,t,n.window,function(){n.RDGE=!0,n.Bwav.forEach(function(e){var t=e.m,r=e.args;n._controller[t].apply(n._controller,Array.from(r))}),null!=r&&me(r)&&(Ze.debug("SDK : Device id is "+n.getClientId()),r({client_id:n.getClientId(),session_id:n.getSessionId()})),n.window.console.info("ApxorSDK initialized for site:"+e+" with SDK version: "+h)},function(){n.RDGE=!1,Ze.error("SDK : Failed to initialize Apxor SDK"),i&&me(i)&&i("")})}}catch(e){n._controller.RDGE=!1,Ze.error("SDK : Exception while initializing Apxor SDK : ",e),i&&me(i)&&i(e)}}),s(this,"eESb",function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"error";Ze.enabled=e,Ze.level=t,Ze.console=n.window.console,Ze.debug("SDK : Logger configured with level ".concat(t))}),s(this,"setIsFlutter",function(e){n.Ysgk=e}),s(this,"isFlutter",function(){return n.Ysgk}),s(this,"registerApxorFlutterHelper",function(e){n.gZTe=e}),s(this,"logEvent",function(e,t){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];n.RDGE?n._controller.cLkC(e,t,void 0,r):n.Bwav.push({m:"cLkC",args:[e,t]})}),s(this,"logClientEvent",function(e,t){n.RDGE?n._controller.logClientEvent(e,t):n.Bwav.push({m:"logClientEvent",args:[e,t]})}),s(this,"logPageView",function(e){n.RDGE?n._controller.logPageView(e):n.Bwav.push({m:"logPageView",args:[e]})}),s(this,"setUserId",function(e){n.RDGE?n._controller.setUserId(e):n.Bwav.push({m:"setUserId",args:[e]})}),s(this,"setUserProperties",function(e){Ze.debug("SDK : User properties set"),n.RDGE?n._controller.setUserProperties(e):n.Bwav.push({m:"setUserProperties",args:[e]})}),s(this,"setSessionProperties",function(e){Ze.debug("SDK : Session properties set"),n.RDGE?n._controller.setSessionProperties(e):n.Bwav.push({m:"setSessionProperties",args:[e]})}),s(this,"setAppVersion",function(e){n.RDGE?n._controller.setAppVersion(e):n.Bwav.push({m:"setAppVersion",args:[e]})}),s(this,"flattenJSON",function(e){n.RDGE?n._controller.flattenJSON(e):n.Bwav.push({m:"flattenJSON",args:[e]})}),s(this,"getSessionId",function(){return n.RDGE?n._controller.getSessionId():null}),s(this,"getClientId",function(){return n._controller.EBLZ()}),s(this,"startNewSession",function(){Ze.debug("SDK : A new session started"),n.RDGE?n._controller.startNewSession(Date.now()):n.Bwav.push({m:"startNewSession",args:[]})}),s(this,"endSession",function(){Ze.debug("SDK : Current session ended"),n.RDGE?n._controller.endSession():n.Bwav.push({m:"endSession",args:[]})}),s(this,"getController",function(){return n._controller}),s(this,"getSiteId",function(){var e;return null===(e=n._controller)||void 0===e?void 0:e.getSiteId()}),s(this,"setRedirectionHandler",function(e){me(e)?n.RDGE?n._controller.setRedirectionHandler(e):n.Bwav.push({m:"setRedirectionHandler",args:[e]}):Ze.error("Callback must be a function")}),s(this,"setInitFlag",function(e){n.RDGE=e}),this.window=t,this._startTime=i,this.Sdrv()}return o(e,[{key:"getApxorFlutterHelper",value:function(){return this.gZTe}}]),e}();window.Apxor=window.Apxor||{_q:[],_st:Date.now()},Pt.prototype._q=window.Apxor._q;var Vt=new Pt(window,+window.Apxor._st);window.Apxor=Vt,window.ApxorLogger=Ze;try{void 0===exports&&null===exports||(exports.default=Vt,module.exports=exports.default)}catch(e){}return Vt});

